name: Multi-Branch Code Scanner

on:
  push:
    branches: ['**']  # ALL BRANCHES
  pull_request:
    branches: ['**']  # ALL BRANCHES

jobs:
  branch-scanner:
    runs-on: ubuntu-latest
    
    steps:
    - name: ğŸ“¥ Checkout Code
      uses: actions/checkout@v3
      
    - name: ğŸ” Branch Information
      run: |
        echo "=== MULTI-BRANCH SCANNER ==="
        echo "ğŸ¯ Scanning Branch: ${{ github.ref }}"
        echo "ğŸ‘¤ Triggered by: ${{ github.actor }}"
        echo "ğŸ“ Commit: ${{ github.sha }}"
        echo "ğŸ•’ Scan Time: $(date)"
        echo "================================="
        
    - name: ğŸ“Š Code Analysis
      run: |
        echo "=== CODE ANALYSIS ==="
        echo "ğŸ“ Total Files: $(find . -type f | grep -v '.git' | wc -l)"
        echo "ğŸ“ JavaScript Files: $(find . -name "*.js" | wc -l)"
        echo "ğŸŒ HTML Files: $(find . -name "*.html" | wc -l)"
        echo "ğŸ“‹ Other Files: $(find . -type f | grep -v '.git' | grep -v '.js' | grep -v '.html' | wc -l)"
        echo "================================="
        
    - name: ğŸ›¡ï¸ Security Scan
      run: |
        echo "=== SECURITY SCAN ==="
        echo "ğŸ” Scanning for sensitive data..."
        if find . -name "*.js" | xargs grep -l "password\|secret\|key" 2>/dev/null; then
          echo "âŒ SECURITY ALERT: Sensitive data found!"
          echo "ğŸš« Blocking this commit..."
          exit 1
        else
          echo "âœ… SECURITY PASS: No sensitive data found"
        fi
        echo "================================="
        
    - name: ğŸ“ˆ Scan Summary
      run: |
        echo "=== SCAN SUMMARY ==="
        echo "âœ… Branch: ${{ github.ref }}"
        echo "âœ… Security: PASSED"
        echo "âœ… Code Analysis: COMPLETED"
        echo "âœ… Status: READY FOR REVIEW"
        echo "ğŸ‘¨â€ğŸ’» Scanned by: Taha's Multi-Branch CI/CD"
        echo "ğŸ¯ Total Branches in Repo: 11"
        echo "================================="
